<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BD-IN SMART APP</title>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #1e3c72; --bg: #f0f3f7; }
        body { font-family: 'Segoe UI', Arial, sans-serif; background: var(--bg); margin: 0; padding-bottom: 70px; }
        .top-header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: bold; }
        .container { padding: 15px; }
        .feature-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .feature-item { background: white; border-radius: 12px; padding: 25px 10px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); border-bottom: 4px solid var(--primary); cursor: pointer; font-weight: bold; }
        #single-view { display: none; background: white; border-radius: 15px; padding: 20px; min-height: 480px; text-align: center; }
        .btn { width: 100%; padding: 14px; border-radius: 10px; border: none; background: var(--primary); color: white; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .input-box { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; }
        .ai-msg { background: #e3f2fd; padding: 15px; border-radius: 10px; margin-top: 10px; border-left: 5px solid #2196f3; text-align: left; font-size: 14px; }
        iframe { width: 100%; height: 350px; border-radius: 10px; margin-top: 15px; display: none; border: 2px solid var(--primary); }
    </style>
</head>
<body onload="renderGrid();">

    <div class="top-header">BD-IN SMART APP | STEP BY STEP</div>

    <div class="container">
        <div class="feature-grid" id="feature-grid"></div>

        <div id="single-view">
            <button onclick="goBack()" style="float:left; padding: 8px 15px; border-radius: 6px; background: #333; color: white; border: none;">‚Üê ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
            <div style="clear:both; padding-top:15px;"></div>
            <h2 id="view-title"></h2>
            <div id="view-content"></div>
        </div>
    </div>

    <script>
        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ö‡¶∞‡¶ø‡¶ú‡¶ø‡¶®‡¶æ‡¶≤ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó
        const firebaseConfig = {
            apiKey: "AIzaSyBSKhDI7bTVOWyiJAJcJESD7B34jZzYwII",
            databaseURL: "https://bd--in-smart-app-default-rtdb.firebaseio.com/",
            projectId: "bd--in-smart-app"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ ‡ß®‡¶ü‡¶ø ‡¶¨‡¶æ‡¶ü‡¶® ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá
        const features = [
            { id: 1, name: "‡¶ü‡ßç‡¶∞‡ßá‡¶® ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶®", icon: "üöÇ" },
            { id: 2, name: "‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™", icon: "üó∫Ô∏è" }
        ];

        function renderGrid() {
            const grid = document.getElementById('feature-grid');
            grid.innerHTML = features.map(f => `<div class="feature-item" onclick="openFeature(${f.id})"><div>${f.icon}</div>${f.name}</div>`).join('');
        }

        function openFeature(id) {
            document.getElementById('feature-grid').style.display = 'none';
            document.getElementById('single-view').style.display = 'block';
            const f = features.find(i => i.id === id);
            document.getElementById('view-title').innerText = f.icon + " " + f.name;

            if(id === 1) {
                // ‡ßß ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®: ‡¶ü‡ßç‡¶∞‡ßá‡¶® ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® (‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ/‡¶á‡¶Ç‡¶∞‡ßá‡¶ú‡¶ø ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö)
                document.getElementById('view-content').innerHTML = `
                    <div class="ai-msg">ü§ñ <b>AI ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶∞:</b> ‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‡¶ì ‡¶≠‡¶æ‡¶∞‡¶§‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡•§ ‡¶ü‡ßç‡¶∞‡ßá‡¶®‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ï‡ßü‡ßá‡¶ï ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§</div>
                    <input id="t-input" class="input-box" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶∏‡ßÅ‡¶¨‡¶∞‡ßç‡¶£ ‡¶¨‡¶æ Benapole">
                    <button class="btn" onclick="searchLogic('train')">‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</button>
                    <div id="res-msg"></div>
                    <iframe id="map-frame"></iframe>
                `;
            } else if(id === 2) {
                // ‡ß® ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶¨‡¶æ‡¶ü‡¶®: ‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ (‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶¨‡¶æ ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡ßü‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ö)
                document.getElementById('view-content').innerHTML = `
                    <div class="ai-msg">ü§ñ <b>GPS AI:</b> ‡¶ï‡ßã‡¶®‡ßã ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶≤‡ßã‡¶ï‡ßá‡¶∂‡¶® ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®‡•§</div>
                    <input id="u-input" class="input-box" placeholder="‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶¨‡¶æ ‡¶Ü‡¶á‡¶°‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®">
                    <button class="btn" onclick="searchLogic('user')">‡¶ú‡¶ø‡¶™‡¶ø‡¶è‡¶∏ ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    <div id="res-msg"></div>
                    <iframe id="map-frame"></iframe>
                `;
            }
        }

        function searchLogic(type) {
            const val = (type === 'train' ? document.getElementById('t-input').value : document.getElementById('u-input').value).trim().toLowerCase();
            const res = document.getElementById('res-msg');
            const map = document.getElementById('map-frame');
            if(!val) return alert("‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®");

            res.innerHTML = `<div class="ai-msg">ü§ñ AI ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶õ‡ßá...</div>`;
            map.style.display = "none";

            db.ref('live_gps').once('value', snapshot => {
                let found = null;
                snapshot.forEach(child => {
                    let d = child.val();
                    let target = type === 'train' ? (d.train || "") : (d.name || child.key);
                    if (target.toLowerCase().includes(val)) found = d;
                });

                if (found) {
                    res.innerHTML = `<div class="ai-msg" style="border-left-color:green">‚úÖ AI ‡¶â‡¶§‡ßç‡¶§‡¶∞: ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶ó‡ßá‡¶õ‡ßá! ‡¶®‡¶ø‡¶ö‡ßá ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶™ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®‡•§</div>`;
                    map.style.display = "block";
                    // OpenStreetMap ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá
                    map.src = `https://www.openstreetmap.org/export/embed.html?bbox=${found.lng-0.005},${found.lat-0.005},${found.lng+0.005},${found.lat+0.005}&layer=mapnik&marker=${found.lat},${found.lng}`;
                } else {
                    res.innerHTML = `<div class="ai-msg" style="border-left-color:red">‚ùå ‡¶¶‡ßÅ‡¶É‡¶ñ‡¶ø‡¶§, ‡¶°‡¶æ‡¶ü‡¶æ‡¶¨‡ßá‡¶∏‡ßá ‡¶è‡¶á ‡¶®‡¶æ‡¶Æ‡ßá ‡¶ï‡¶æ‡¶â‡¶ï‡ßá ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§</div>`;
                }
            });
        }

        function goBack() {
            document.getElementById('feature-grid').style.display = 'grid';
            document.getElementById('single-view').style.display = 'none';
        }
    </script>
</body>
</html>
